{"version":3,"sources":["server/controllers/auth.js"],"names":["config","require","user","username","password","login","req","res","next","body","token","sign","role","app","getRequestOrigin","headers","origin","jwtSecret","json","err","UNAUTHORIZED","getRandomNumber","num","Math","random"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAGA,IAAMA,SAASC,QAAQ,kBAAR,CAAf;;AAEA;AACA,IAAMC,OAAO;AACXC,YAAU,OADC;AAEXC,YAAU;AAFC,CAAb;;AAKA;;;;;;;AAOA,SAASC,KAAT,CAAeC,GAAf,EAAoBC,GAApB,EAAyBC,IAAzB,EAA+B;AAC7B;AACA;AACA,MAAIF,IAAIG,IAAJ,CAASN,QAAT,KAAsBD,KAAKC,QAA3B,IAAuCG,IAAIG,IAAJ,CAASL,QAAT,KAAsBF,KAAKE,QAAtE,EAAgF;AAAC;AAC/E,QAAMM,QAAQ,uBAAIC,IAAJ,CAAS;AACrBR,gBAAUD,KAAKC,QADM;AAErBS,YAAM,OAFe,EAEN;AACfC,WAAK,eAAMC,gBAAN,CAAuBR,IAAIS,OAAJ,CAAYC,MAAnC;AAHgB,KAAT,EAIXhB,OAAOiB,SAJI,CAAd;AAKA,WAAOV,IAAIW,IAAJ,CAAS;AACdR,kBADc;AAEdP,gBAAUD,KAAKC;AAFD,KAAT,CAAP;AAID;;AAED,MAAMgB,MAAM,uBAAa,sBAAb,EAAqC,qBAAWC,YAAhD,CAAZ;AACA,SAAOZ,KAAKW,GAAL,CAAP;AACD;;AAED;;;;;;AAMA,SAASE,eAAT,CAAyBf,GAAzB,EAA8BC,GAA9B,EAAmC;AACjC;AACA,SAAOA,IAAIW,IAAJ,CAAS;AACdhB,UAAMI,IAAIJ,IADI;AAEdoB,SAAKC,KAAKC,MAAL,KAAgB;AAFP,GAAT,CAAP;AAID;;kBAEc,EAAEnB,YAAF,EAASgB,gCAAT,E","file":"server/controllers/auth.js","sourceRoot":"../../.."}